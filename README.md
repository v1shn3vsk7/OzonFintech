Для выбора типа хранилища необходимо
перейти в файл [docker-compose.yml](https://github.com/v1shn3vsk7/URL-shortener/blob/main/docker-compose.yml) и изменить переменную окружения `STORE_TYPE` на `STORE_TYPE=inmemory`, для использования сервером **in-memory** хранилища или на `STORE_TYPE=postgres` для использования БД 
## Запуск сервера:
Из папки проекта:
`docker-compose up --build` (zsh)

## Запросы:
### HTTP
`[POST] /createShortUrl`
```
localhost:8080/createShortUrl
```
```
В теле запроса передаем json, например:
{
    "URL": "https://google.com"
}

Получаем ответ:
["b"]
```

`[GET] /`
```
localhost:8080/b
```


```
Ответ:
["https://google.com"]
```

### gRPC
`localhost:5536/CreateShortUrl`
```
В Message запроса указываем URL:
{
    "Url": "https://github.com"
}
```

```
Ответ:
{
    "Url": "c"
}
```

`localhost:5536/GetOriginUrl`
```
В Message запроса используем сокращенную ссылку:
{
    "Url": "c"
}
```

```
Ответ:
{
    "Url": "https://github.com"
}
```

## Реализация алгоритма сокращения ссылки
По условию тестового задания на один оригинальный URL должна ссылаться только одна сокращенная ссылка. Так как все оригинальные URL заносятся в БД,
то гарантируется, что столбец id будет уникальным для каждой ссылки, поэтому мы используем это поле
для получения её сокращенной версии.

Функция хеширования принимает на вход целое число - id оригинальной URL и возвращает сокращенную ссылку:
```
func HashUrl(id int) string
```

Далее создаем алфавит доступных нам символов для хеширования:
```
var alp = []rune {'a','b','c','d','e','f','g','h','i',
		'j','k','l','m','n','o','p','q','r','s','t','u','v',
		'w','x','y','z', 'A','B','C','D','E','F','G','H','I',
		'J','K','L','M','N','O','P','Q','R','S','T','U','V',
		'W','X','Y','Z', '0','1','2','3','4','5','6','7','8',
		'9','0', '_'}
```

Получаем длину алфавита:
```
base := len(alp)
```

Объявляем срез рун. Далее переводим id в число с основанием 63 (размер алфавита)
и добавляем символ из алфавита по полученному индексу в срез.
```
var hash []rune

	for id > 0 {
		hash = append(hash, alp[id % base])
		id /= base
	}
```

Переворачиваем срез, кастуем его к string и возвращаем
```
for i, j := 0, len(hash)-1; i < j; i, j = i+1, j-1 {
		hash[i], hash[j] = hash[j], hash[i]
	}

	return string(hash)
```





